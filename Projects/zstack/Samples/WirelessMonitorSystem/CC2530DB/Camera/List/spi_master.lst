###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         13/Jul/2015  17:24:01 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-CC2530-2.5.1a\Componen #
#                          ts\hal\target\CC2530EB\spi_master.c                #
#    Command line       =  -f "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Proj #
#                          ects\zstack\Samples\WirelessMonitorSystem\CC2530DB #
#                          \..\..\..\Tools\CC2530DB\f8wEndev.cfg"             #
#                          (-DCPU32MHZ -DROOT=__near_func                     #
#                          -DMAC_CFG_TX_DATA_MAX=3 -DMAC_CFG_TX_MAX=6         #
#                          -DMAC_CFG_RX_MAX=3) -f "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\Too #
#                          ls\CC2530DB\f8wConfig.cfg" (-DZIGBEEPRO            #
#                          -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR       #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=500         #
#                          -DQUEUED_POLL_RATE=30 -DRESPONSE_POLL_RATE=100)    #
#                          -DREJOIN_POLL_RATE=440 "C:\Texas                   #
#                          Instruments\ZStack-CC2530-2.5.1a\Components\hal\ta #
#                          rget\CC2530EB\spi_master.c" -D HAL_UART -lC        #
#                          "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\Samples\WirelessMonitorSystem\CC2530DB\Ca #
#                          mera\List\" -lA "C:\Texas                          #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\Camera\List\ #
#                          " --diag_suppress Pe001,Pa010 -o "C:\Texas         #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\Camera\Obj\" #
#                           -e --no_cse --no_unroll --no_inline               #
#                          --no_code_motion --no_tbaa --debug --core=plain    #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\" -I         #
#                          "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Project #
#                          s\zstack\Samples\WirelessMonitorSystem\CC2530DB\.. #
#                          \Source\" -I "C:\Texas Instruments\ZStack-CC2530-2 #
#                          .5.1a\Projects\zstack\Samples\WirelessMonitorSyste #
#                          m\CC2530DB\..\..\..\ZMain\TI2530DB\" -I "C:\Texas  #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\hal\include\" -I "C:\Texas           #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\hal\target\CC2530EB\" -I "C:\Texas   #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\mac\include\" -I "C:\Texas           #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\mac\high_level\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\mac\low_level\srf04\" -I "C:\Texas   #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\mac\low_level\srf04\single_chip\"    #
#                          -I "C:\Texas Instruments\ZStack-CC2530-2.5.1a\Proj #
#                          ects\zstack\Samples\WirelessMonitorSystem\CC2530DB #
#                          \..\..\..\..\..\Components\mt\" -I "C:\Texas       #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\osal\include\" -I "C:\Texas          #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\services\saddr\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\services\sdata\" -I "C:\Texas        #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\stack\af\" -I "C:\Texas              #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\stack\nwk\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\stack\sapi\" -I "C:\Texas            #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\stack\sec\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\stack\sys\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\stack\zdo\" -I "C:\Texas             #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\zmac\" -I "C:\Texas                  #
#                          Instruments\ZStack-CC2530-2.5.1a\Projects\zstack\S #
#                          amples\WirelessMonitorSystem\CC2530DB\..\..\..\..\ #
#                          ..\Components\zmac\f8w\" -On --require_prototypes  #
#    List file          =  C:\Texas Instruments\ZStack-CC2530-2.5.1a\Projects #
#                          \zstack\Samples\WirelessMonitorSystem\CC2530DB\Cam #
#                          era\List\spi_master.lst                            #
#    Object file        =  C:\Texas Instruments\ZStack-CC2530-2.5.1a\Projects #
#                          \zstack\Samples\WirelessMonitorSystem\CC2530DB\Cam #
#                          era\Obj\spi_master.r51                             #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-CC2530-2.5.1a\Components\hal\target\CC2530EB\spi_master.c
      1          /*******************************************************************************
      2          date   : 2010/08/20
      3          writer ：on the way
      4          
      5          Port   ：P0_2,P0_3,P0_4,P0_5  这四个端口是用于UART0外设配置
      6                   P1_0，P1_1           这两个端口是LED1和LED2
      7                   P1_4,P1_5,P1_6,P1_7  这四个端口用于SPI通信
      8          
      9          fuction：SPI通信主模式
     10                   配置好寄存器之后，直接进入发送数据的状态
     11          *******************************************************************************/
     12          /*-------------------------------------------------------------------------------- 
     13              Master                 Slave 
     14          -------------          ------------- 
     15          |           |          |           | 
     16          |P1_4   SSN |--------->|SSN    P1_4| 
     17          |           |          |           | 
     18          |P1_5   SCK |--------->|SCK    P1_5| 
     19          |           |          |           | 
     20          |P1_6   MOSI|--------->|MOSI   P1_7| 
     21          |           |          |           | 
     22          |P1_7   MISO|<---------|MISO   P1_6| 
     23          |           |          |           | 
     24          -------------          ------------- 
     25          --------------------------------------------------------------------------------*/
     26          // Master Mode
     27          #include "ioCC2530.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf1
   \   unsigned char volatile __sfr PERCFG
   \                     PERCFG:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf4
   \   unsigned char volatile __sfr P1SEL
   \                     P1SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf8
   \   union <unnamed> volatile __sfr _A_U1CSR
   \                     _A_U1CSR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf9
   \   unsigned char volatile __sfr U1DBUF
   \                     U1DBUF:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfa
   \   unsigned char volatile __sfr U1BAUD
   \                     U1BAUD:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfc
   \   unsigned char volatile __sfr U1GCR
   \                     U1GCR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     28          #include "ADXL345SPI.h"
     29          
     30          #define SSN     P1_4
     31          
     32          #define LOW 	0
     33          #define HIGH 	1
     34          
     35          typedef unsigned char byte;
     36          
     37          /***************************Port Init OK*************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     38          void init_port(void)
   \                     init_port:
     39          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
     40             PERCFG |= 0x02;        // PERCFG.U1CFG = 1 
   \   000000   43F102       ORL     0xf1,#0x2
     41             P1SEL |= 0xE0;         // P1_7, P1_6, and P1_5 are peripherals 
   \   000003   43F4E0       ORL     0xf4,#0xe0
     42             P1SEL &= ~0x10;        // P1_4 is GPIO (SSN) 
   \   000006   53F4EF       ANL     0xf4,#0xef
     43             P1DIR |= 0x10;         // SSN is set as output 
   \   000009   43FE10       ORL     0xfe,#0x10
     44          }
   \   00000C   02....       LJMP    ?BRET
   \   00000F                REQUIRE PERCFG
   \   00000F                REQUIRE P1SEL
   \   00000F                REQUIRE P1DIR
     45          
     46          
     47          // in cc 2530 will get 4 MHZ
     48          // this means we must use the data rate of 3200 HZ
     49          /********* init_Baudrate ********/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     50          void init_Baudrate(void)
   \                     init_Baudrate:
     51          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
     52            // Set baud rate to max (system clock frequency / 8) 
     53            // Assuming a 26 MHz crystal (CC1110Fx/CC2510Fx), 
     54            // max baud rate = 26 MHz / 8 = 3.25 MHz.  
     55            U1BAUD = 0;   // BAUD_M = 0 
   \   000000   75FA00       MOV     0xfa,#0x0
     56            U1GCR |= 15;   // BAUD_E = 17
   \   000003   43FC0F       ORL     0xfc,#0xf
     57          }
   \   000006   02....       LJMP    ?BRET
   \   000009                REQUIRE U1BAUD
   \   000009                REQUIRE U1GCR
     58          
     59          /********************SPI Init Master******************/
     60          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     61          void Init_Spi(void)
   \                     Init_Spi:
     62          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     63            init_port();      //初始化端口
   \   000004                ; Setup parameters for call to function init_port
   \   000004   12....       LCALL   ??init_port?relay
     64            init_Baudrate();  //初始化波特率
   \   000007                ; Setup parameters for call to function init_Baudrate
   \   000007   12....       LCALL   ??init_Baudrate?relay
     65            
     66            // SPI Master Mode 
     67            U1CSR &= ~0xA0;   //选择为SPI为Master
   \   00000A   53F85F       ANL     0xf8,#0x5f
     68            
     69            // Configure phase, polarity, and bit order 
     70            // this  configure should be done before the 
     71            // adxl345 powered
     72            // if adxl345 is powers, you should keep the CS be high
     73            SSN = HIGH;
   \   00000D   D294         SETB    0x90.4
     74            //U1GCR &= ~0xC0;      // CPOL = CPHA = 0
     75            //U1GCR |= 0x20;       // ORDER = 1 
     76            
     77            // CPOL = CPHA = 1 ORDER = 1 
     78            U1GCR |= 0xC0;
   \   00000F   43FCC0       ORL     0xfc,#0xc0
     79            U1GCR |= 0x20;
   \   000012   43FC20       ORL     0xfc,#0x20
     80          }
   \   000015   D083         POP     DPH
   \   000017   D082         POP     DPL
   \   000019   02....       LJMP    ?BRET
   \   00001C                REQUIRE _A_U1CSR
   \   00001C                REQUIRE _A_P1
   \   00001C                REQUIRE U1GCR
     81          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     82          void spiWait(byte counter)
   \                     spiWait:
     83          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
     84            while(counter--);
   \                     ??spiWait_0:
   \   000000   E9           MOV     A,R1
   \   000001   F8           MOV     R0,A
   \   000002   74FF         MOV     A,#-0x1
   \   000004   28           ADD     A,R0
   \   000005   F9           MOV     R1,A
   \   000006   E8           MOV     A,R0
   \   000007   70F7         JNZ     ??spiWait_0
     85          }
   \   000009   02....       LJMP    ?BRET
     86          
     87          /*********** Read a byte From ADXL345 *************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     88          void ADXL345Read(unsigned char multi, unsigned char len, unsigned char* buffer, unsigned char startReg)
   \                     ADXL345Read:
     89          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
     90            unsigned char i;
     91            // -------- 0/1 000 0000
     92            // --------- 1 for read
     93            unsigned char firstByte = 0x80;	
   \   000005   75..80       MOV     ?V0 + 2,#-0x80
     94            
     95            if(1 == multi)
   \   000008   7401         MOV     A,#0x1
   \   00000A   69           XRL     A,R1
   \   00000B   7007         JNZ     ??ADXL345Read_0
     96            {
     97          	firstByte |= 0x40;
   \   00000D   D3           SETB    C
   \   00000E   E5..         MOV     A,?V0 + 2
   \   000010   92E6         MOV     0xE0 /* A   */.6,C
   \   000012   F5..         MOV     ?V0 + 2,A
     98            }
     99          	
    100            // fill reg address
    101            firstByte |= startReg;
   \                     ??ADXL345Read_0:
   \   000014   EB           MOV     A,R3
   \   000015   42..         ORL     ?V0 + 2,A
    102            
    103            // send the reg address
    104            // select the slave 
    105            SSN = LOW;
   \   000017   C294         CLR     0x90.4
    106            U1DBUF = firstByte; //加入要发送的数据
   \   000019   85..F9       MOV     0xf9,?V0 + 2
    107            while (!U1TX_BYTE);  
   \                     ??ADXL345Read_1:
   \   00001C   A2F9         MOV     C,0xf8.1
   \   00001E   50FC         JNC     ??ADXL345Read_1
    108            U1TX_BYTE = 0;
   \   000020   C2F9         CLR     0xf8.1
    109            
    110            // prepare to read
    111            for (i = 0; i < len; i++) 
   \   000022   7800         MOV     R0,#0x0
   \                     ??ADXL345Read_2:
   \   000024   E8           MOV     A,R0
   \   000025   C3           CLR     C
   \   000026   9A           SUBB    A,R2
   \   000027   5022         JNC     ??ADXL345Read_3
    112            { 
    113              while (U1RX_BYTE); 
   \                     ??ADXL345Read_4:
   \   000029   A2FA         MOV     C,0xf8.2
   \   00002B   40FC         JC      ??ADXL345Read_4
    114          	buffer[i] = U1DBUF;
   \   00002D   E5F9         MOV     A,0xf9
   \   00002F   C0E0         PUSH    A
   \   000031   88..         MOV     ?V0 + 0,R0
   \   000033   75..00       MOV     ?V0 + 1,#0x0
   \   000036   EC           MOV     A,R4
   \   000037   25..         ADD     A,?V0 + 0
   \   000039   F582         MOV     DPL,A
   \   00003B   ED           MOV     A,R5
   \   00003C   35..         ADDC    A,?V0 + 1
   \   00003E   F583         MOV     DPH,A
   \   000040   D0E0         POP     A
   \   000042   F0           MOVX    @DPTR,A
    115              U1RX_BYTE = 0;
   \   000043   C2FA         CLR     0xf8.2
    116          	
    117          	if(!multi)
   \   000045   E9           MOV     A,R1
   \   000046   6003         JZ      ??ADXL345Read_3
    118          	{
    119          	  break;
    120          	}
    121            }
   \   000048   08           INC     R0
   \   000049   80D9         SJMP    ??ADXL345Read_2
    122            
    123            // stop
    124            SSN = HIGH;
   \                     ??ADXL345Read_3:
   \   00004B   D294         SETB    0x90.4
    125          }
   \   00004D   7F03         MOV     R7,#0x3
   \   00004F   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000052                REQUIRE _A_P1
   \   000052                REQUIRE U1DBUF
   \   000052                REQUIRE _A_U1CSR
    126          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    127          void ADXL345Write(unsigned char multi, unsigned char len, unsigned char* buffer, unsigned char startReg)
   \                     ADXL345Write:
    128          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
    129              unsigned char i;
    130            // -------- 0/1 000 0000
    131            // --------- 0 for write
    132            unsigned char firstByte = 0x00;	
   \   000005   75..00       MOV     ?V0 + 2,#0x0
    133            
    134            if(1 == multi)
   \   000008   7401         MOV     A,#0x1
   \   00000A   69           XRL     A,R1
   \   00000B   7007         JNZ     ??ADXL345Write_0
    135            {
    136          	firstByte |= 0x40;
   \   00000D   D3           SETB    C
   \   00000E   E5..         MOV     A,?V0 + 2
   \   000010   92E6         MOV     0xE0 /* A   */.6,C
   \   000012   F5..         MOV     ?V0 + 2,A
    137            }
    138          	
    139            // fill reg address
    140            firstByte |= startReg;
   \                     ??ADXL345Write_0:
   \   000014   EB           MOV     A,R3
   \   000015   42..         ORL     ?V0 + 2,A
    141            
    142            // send the reg address
    143            // select the slave 
    144            SSN = LOW;
   \   000017   C294         CLR     0x90.4
    145            U1DBUF = firstByte; 
   \   000019   85..F9       MOV     0xf9,?V0 + 2
    146            while (!U1TX_BYTE); 
   \                     ??ADXL345Write_1:
   \   00001C   A2F9         MOV     C,0xf8.1
   \   00001E   50FC         JNC     ??ADXL345Write_1
    147            U1TX_BYTE = 0;
   \   000020   C2F9         CLR     0xf8.1
    148            
    149            // prepare to write
    150            for (i = 0; i < len; i++) 
   \   000022   7800         MOV     R0,#0x0
   \                     ??ADXL345Write_2:
   \   000024   E8           MOV     A,R0
   \   000025   C3           CLR     C
   \   000026   9A           SUBB    A,R2
   \   000027   501E         JNC     ??ADXL345Write_3
    151            { 
    152          	U1DBUF = buffer[i];
   \   000029   88..         MOV     ?V0 + 0,R0
   \   00002B   75..00       MOV     ?V0 + 1,#0x0
   \   00002E   EC           MOV     A,R4
   \   00002F   25..         ADD     A,?V0 + 0
   \   000031   F582         MOV     DPL,A
   \   000033   ED           MOV     A,R5
   \   000034   35..         ADDC    A,?V0 + 1
   \   000036   F583         MOV     DPH,A
   \   000038   E0           MOVX    A,@DPTR
   \   000039   F5F9         MOV     0xf9,A
    153              while (!U1TX_BYTE); 
   \                     ??ADXL345Write_4:
   \   00003B   A2F9         MOV     C,0xf8.1
   \   00003D   50FC         JNC     ??ADXL345Write_4
    154              U1TX_BYTE = 0;
   \   00003F   C2F9         CLR     0xf8.1
    155          	
    156          	if(!multi)
   \   000041   E9           MOV     A,R1
   \   000042   6003         JZ      ??ADXL345Write_3
    157          	{
    158          	  break;
    159          	}
    160            }
   \   000044   08           INC     R0
   \   000045   80DD         SJMP    ??ADXL345Write_2
    161          
    162            // stop
    163            SSN = HIGH;
   \                     ??ADXL345Write_3:
   \   000047   D294         SETB    0x90.4
    164          }
   \   000049   7F03         MOV     R7,#0x3
   \   00004B   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   00004E                REQUIRE _A_P1
   \   00004E                REQUIRE U1DBUF
   \   00004E                REQUIRE _A_U1CSR
    165          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    166          void InitADXL345( void )
   \                     InitADXL345:
    167          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    168            Init_Spi();
   \   000004                ; Setup parameters for call to function Init_Spi
   \   000004   12....       LCALL   ??Init_Spi?relay
    169            // use 4 -wrie mode
    170            // default is 4 wire so do nothing 
    171          }
   \   000007   D083         POP     DPH
   \   000009   D082         POP     DPL
   \   00000B   02....       LJMP    ?BRET

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??init_port?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    init_port

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??init_Baudrate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    init_Baudrate

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??Init_Spi?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    Init_Spi

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??spiWait?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    spiWait

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ADXL345Read?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ADXL345Read

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ADXL345Write?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ADXL345Write

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??InitADXL345?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    InitADXL345

   Maximum stack usage in bytes:

     Function           ISTACK PSTACK XSTACK
     --------           ------ ------ ------
     ADXL345Read            1      0     11
     ADXL345Write           0      0     11
     InitADXL345            2      0      0
       -> Init_Spi          4      0      0
     Init_Spi               2      0      0
       -> init_port         4      0      0
       -> init_Baudrate     4      0      0
     init_Baudrate          0      0      0
     init_port              0      0      0
     spiWait                0      0      0


   Segment part sizes:

     Function/Label        Bytes
     --------------        -----
     _A_P1                    1
     PERCFG                   1
     P1SEL                    1
     _A_U1CSR                 1
     U1DBUF                   1
     U1BAUD                   1
     U1GCR                    1
     P1DIR                    1
     init_port               15
     init_Baudrate            9
     Init_Spi                28
     spiWait                 12
     ADXL345Read             82
     ADXL345Write            78
     InitADXL345             14
     ??init_port?relay        6
     ??init_Baudrate?relay    6
     ??Init_Spi?relay         6
     ??spiWait?relay          6
     ??ADXL345Read?relay      6
     ??ADXL345Write?relay     6
     ??InitADXL345?relay      6

 
 238 bytes in segment BANKED_CODE
  42 bytes in segment BANK_RELAYS
   8 bytes in segment SFR_AN
 
 280 bytes of CODE memory
   0 bytes of DATA memory (+ 8 bytes shared)

Errors: none
Warnings: none
